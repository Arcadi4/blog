.animated-link {
  display: inline-block;
  width: fit-content;
  position: relative;
  text-decoration: none;
  cursor: none;

  /*
   * The underline is drawn as a background gradient pinned to the
   * bottom of the text. background-size width starts at 0 and
   * transitions to 100 % on hover -> left-to-right reveal.
   */
  background-image: linear-gradient(currentColor, currentColor);
  background-position: 0 calc(92%);
  background-repeat: no-repeat;
  background-size: 0% var(--underline-thickness, 2px);
  transition: background-size 0.4s cubic-bezier(0.33, 0, 0.2, 1);

  /*
   * Skip-ink effect via text-shadow.
   * Set --link-bg on any ancestor to the local background colour;
   * the shadow punches out the underline around descenders (g p y ...).
   * When --link-bg is unset the fallback is `transparent`, so the
   * underline simply runs uninterrupted - no hard-coded colour needed.
   */
  text-shadow:
     0.04em 0     var(--link-bg, transparent),
    -0.04em 0     var(--link-bg, transparent),
     0.09em 0     var(--link-bg, transparent),
    -0.09em 0     var(--link-bg, transparent),
     0.04em 0.04em var(--link-bg, transparent),
    -0.04em 0.04em var(--link-bg, transparent);
}

.animated-link:hover,
.animated-link:focus-visible {
  background-size: 100% var(--underline-thickness, 2px);
}

/* Remove the shadow mask when text is selected so
   the selection highlight isn't broken */
.animated-link::selection {
  text-shadow: none;
  background: currentColor;
  color: var(--link-bg, var(--background));
}

.animated-link::-moz-selection {
  text-shadow: none;
  background: currentColor;
  color: var(--link-bg, var(--background));
}
